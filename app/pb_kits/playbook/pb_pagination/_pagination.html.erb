<!-- Pagination -->
<%= content_tag(:div,
  aria: object.aria,
  class: object.classname,
  data: object.data,
  id: object.id) do %>
  
  <%= pb_rails("card",props:{padding:"none"}) do %>
    <%= pb_rails("flex",props:{vertical:"center"}) do %>
     <%= pb_rails("circle_icon_button", props: { variant:"link", icon: "angle-left", size:"md", classname:"paginate-backward", data:{paginate:"backward"}}) %>
    <!-- Basic -->
    <% if object.classname.include? "_basic" %>
      <div class="line"></div>
      
    <!-- Collapsed -->
    <% elsif object.classname.include? "_collapsed" %>
      <div class="line"></div>
      <span class="paginate-body">
        <%= object.target_page %>
      </span>
      <div class="line"></div>

    <!-- Scroll -->
    <% elsif object.classname.include? "_scroll" %>
      <div class="line"></div>
        <span class="paginate-body">
          <%= object.number_of_pages object.target_page, @per_page, @total_items %>
        </span>
      <div class="line"></div>



    <!-- Expanded -->
      <% elsif object.classname.include? "_expanded" %>
        <div class="line"></div>
            <span class="paginate-body">
              <span class="range">
                <% object.calculate_page_range.each do |page| %>
                  <span class="range-item <%= object.target_page == page ? 'active': '' %>">
                    <%= page %>
                  </span>
                <% end %>
              </span>
            </span>
        <div class="line"></div>  
      <% end %>
    

      <%= pb_rails("circle_icon_button", props: { variant:"link", icon: "angle-right", size:"lg", classname:"paginate-forward", data:{paginate:"forward"}}) %>
    <% end %>
  <% end %>
<% end %>
<script>
  paginateRight = document.querySelector('.paginate-forward');
  paginateLeft = document.querySelector('.paginate-backward');

  function triggerPagination() {
    let newPageNumber;
    let direction = event.target.dataset.paginate;
    let urlParams = new URLSearchParams(location.search);
    let currentPageNumber = parseInt(urlParams.get('page'));

    if (isNaN(currentPageNumber)) {
      newPageNumber = 1;
      window.location.href = `${location.origin + location.pathname}?page=${newPageNumber}`;

      return;
    }

    if (direction == "forward") {
      newPageNumber = currentPageNumber + 1
    } else if (currentPageNumber == 1) {
      newPageNumber = currentPageNumber
    } else {
      newPageNumber = currentPageNumber - 1
    }

    window.location.href = `${location.origin + location.pathname}?page=${newPageNumber}`;
  }

  paginateRight.addEventListener('click', triggerPagination);
  paginateLeft.addEventListener('click', triggerPagination);
</script>
